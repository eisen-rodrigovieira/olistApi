CREATE OR REPLACE PROCEDURE AD_STP_MKP_FATURAPEDIDO(
                    P_NUNOTA      IN  NUMBER,    -- Número único do pedido
                    P_IDSEPARACAO IN  NUMBER,    -- ID da separação do pedido no Olist
                    P_DTSEPARACAO IN  VARCHAR2,  -- Data da separação do pedido no Olist
                    P_DTFATURADO  IN  VARCHAR2,  -- Data do checkout do pedido no Olist
                    P_IDNFE       IN  NUMBER,    -- ID da NFe gerada no Olist
                    P_NUMNFE      IN  NUMBER,    -- Número da NFe gerada no Olist
                    P_NUNOTA_NOTA OUT NUMBER     -- Número único da nota no Sankhya

) AS
    V_NUNOTA_NOTA TGFCAB.NUNOTA%TYPE;
    V_SERIE_NOTA  TGFNUM.SERIE%TYPE;

BEGIN

    /*******************************************************************************

    @Autor: Rodrigo Vieira <rodrigo.vieira@grupoeisen.com.br>
    @Data: 13/06/2025
    @Objetivo: Gera uma nota a partir do pedido de venda que foi importado do Olist

    ********************************************************************************/

    SELECT ULTCOD + 1
    INTO V_NUNOTA_NOTA
    FROM TGFNUM
    WHERE ARQUIVO = 'TGFCAB';

    SELECT SERIE
    INTO V_SERIE_NOTA
    FROM TGFNUM
    WHERE ARQUIVO = 'VENDA'
        AND CODEMP = 31 
        AND CODMODDOC = 55;

    -- INSERINDO CABEÇALHO DA NOTA
    BEGIN
        INSERT INTO TGFCAB
        (   AD_ABAMERCOS,
            AD_ABATERDEVOLUCAO,
            AD_CODLOCALIVT,
            AD_CONTAGEM,
            AD_CONTP,
            AD_DHCONFIRMVDY,
            AD_DHCRIACAOVDY,
            AD_DTCONTAGEM,
            AD_DTFATURAMENTO,
            AD_IDSHOPEE,
            AD_ISAID,
            AD_ISAORDERNUMBER,
            AD_MKP_CODPED,
            AD_MKP_DESTINO,
            AD_MKP_DHCHECKOUT,
            AD_MKP_DHSEPARACAO,
            AD_MKP_ID,
            AD_MKP_IDNFE,
            AD_MKP_IDSEPARACAO,
            AD_MKP_NUMPED,
            AD_MKP_ORIGEM,
            AD_NUMCONTRATO,
            AD_NUMLAT,
            AD_NUMLONG,
            AD_NUNOTACONVERSAO,
            AD_NUVIDYA,
            AD_OBSFISCO,
            AD_OFFLINE,
            AD_TAXASHOPEE,
            AD_VDYORIG,
            AGRUPFINNOTA,
            ALIQIRF,
            ANTT,
            APROVADO,
            BASECOFINS,
            BASECOFINSST,
            BASEICMS,
            BASEICMSAT,
            BASEICMSFRETE,
            BASEICMSSTFRETE,
            BASEINSS,
            BASEIPI,
            BASEIRF,
            BASEISS,
            BASEPIS,
            BASEPISST,
            BASESUBSTIT,
            BASESUBSTSEMRED,
            CARACAD,
            CARACSER,
            CHAVECTE,
            CHAVECTEREF,
            CHAVENFCOM,
            CHAVENFE,
            CHAVENFEREF,
            CHAVENFSE,
            CHAVESINIEF1324,
            CHVNFEINEREF,
            CIF_FOB,
            CIOT,
            CLASCONS,
            CLASSIFICMS,
            CLIENTEIDPARCERIA,
            CNPJADQUIRENTE,
            CODART,
            CODCC,
            CODCENCUS,
            CODCHECKOUT,
            CODCID,
            CODCIDDESTINO,
            CODCIDENTREGA,
            CODCIDFIMCTE,
            CODCIDINICTE,
            CODCIDORIGEM,
            CODCIDPREST,
            CODCONTATO,
            CODCONTATOENTREGA,
            CODDOCA,
            CODDOCARRECAD,
            CODEMP,
            CODEMPFUNC,
            CODEMPNEGOC,
            CODFUNC,
            CODGRUPOTENSAO,
            CODGUF,
            CODINTERM,
            CODMAQ,
            CODMODDOCNOTA,
            CODMOEDA,
            CODMOTORISTA,
            CODNAT,
            CODOBRA,
            CODOBSPADRAO,
            CODPARC,
            CODPARCCONSIGNATARIO,
            CODPARCDESCARGAMDFE,
            CODPARCDEST,
            CODPARCREDESPACHO,
            CODPARCREMETENTE,
            CODPARCRETIRADA,
            CODPARCTRANSP,
            CODPARCTRANSPFINAL,
            CODPROJ,
            CODRASTREAMENTOECT,
            CODSITE,
            CODTIPOPER,
            CODTIPVENDA,
            CODTPD,
            CODUFDESTINO,
            CODUFENTREGA,
            CODUFORIGEM,
            CODUSU,
            CODUSUCOMPRADOR,
            CODUSUINC,
            CODVEICULO,
            CODVEND,
            CODVENDTEC,
            CODVTP,
            COMGER,
            COMISSAO,
            CONFIRMNOTAFAT,
            CPFCNPJADQUIRENTE,
            CPFRESPTEC,
            CTEGLOBAL,
            CTELOTACAO,
            DANFE,
            DHEMISSEPEC,
            DHPROTOC,
            DHPROTOCCTE,
            DHREGDPEC,
            DHTIPOPER,
            DHTIPVENDA,
            DHVIAGEM,
            DIGITAL,
            DIRECAOVIAG,
            DISDESAUTIMPEMB,
            DTADIAM,
            DTALTER,
            DTCONTAB,
            DTDECLARA,
            DTENTSAI,
            DTENTSAIINFO,
            DTENVIOPMB,
            DTENVSUF,
            DTESCRCONT,
            DTFATUR,
            DTMOV,
            DTNEG,
            DTPREVENT,
            DTREF,
            DTREF2,
            DTREF3,
            DTREMRET,
            DTVAL,
            EXIGEISSQN,
            FISTEL,
            FORMPGTCTE,
            FRETEVLRPAGO,
            FUSOEMISSEPEC,
            HISTCONFIG,
            HRADIAM,
            HRENTSAI,
            HRMOV,
            ICMSFRETE,
            ICMSSTFRETE,
            IDBALSA01,
            IDBALSA02,
            IDBALSA03,
            IDDESCPARCERIA,
            IDIPROC,
            IDNAVIO,
            IDPONTUACAOPARCERIA,
            INDNEGMODAL,
            INDPRESNFCE,
            INTERMED,
            IPIEMB,
            IRFRETIDO,
            IRINNAVIO,
            ISSRETIDO,
            KMVEICULO,
            LACRES,
            LATITUDE,
            LIBCONF,
            LOCALCOLETA,
            LOCALENTREGA,
            LOCEMBARQ,
            LONGITUDE,
            LOTACAO,
            M3,
            MARCA,
            MD5MODCOMTEL,
            MODELONFDES,
            MODENTREGA,
            MODRECEBPDVWEB,
            MOTNAORETERISSQN,
            NATUREZAOPERDES,
            NFEDEVRECUSA,
            NFSEID,
            NOMEADQUIRENTE,
            NOTAEMPENHO,
            NOTAPORPEDIDOPDV,
            NOTASCF,
            NROCAIXA,
            NROREDZ,
            NUCFR,
            NUCONFATUAL,
            NUFOP,
            NULOTECTE,
            NULOTENFCOM,
            NULOTENFE,
            NULOTENFSE,
            NUMALEATORIO,
            NUMALEATORIOCTE,
            NUMCF,
            NUMCONTRATO,
            NUMCOTACAO,
            NUMCSTC,
            NUMDOCARRECAD,
            NUMERACAOVOLUMES,
            NUMGUIA,
            NUMNFSE,
            NUMNOTA,
            NUMOS,
            NUMPEDIDO2,
            NUMPROTOC,
            NUMPROTOCCTE,
            NUMPROTOCINCTE,
            NUMPROTOCINNFE,
            NUMPROTOCNFCOM,
            NUMRECEITAGRO,
            NUMREGDPEC,
            NUMTERMTEL,
            NUNOTA,
            NUNOTAPEDFRET,
            NUNOTAREC,
            NUNOTASUB,
            NUODP,
            NUPCA,
            NUPEDFRETE,
            NURD8,
            NURECEBIMENTO,
            NUREM,
            NUSESSAO,
            NUTRANSF,
            OBSERVACAO,
            OCCN48,
            ORDEMCARGA,
            PENDENTE,
            PERCDESC,
            PERCDESCFOB,
            PERMALTERCENTRAL,
            PESO,
            PESOBRUTO,
            PESOBRUTOMANUAL,
            PESOLIQUIMANUAL,
            PLACA,
            PREMIACAOESTADUAL,
            PRODPRED,
            PRODUETLOC,
            QTDUSU,
            QTDVOL,
            RATEADO,
            REBOQUE1,
            REBOQUE2,
            REBOQUE3,
            REGESPTRIBUT,
            RETGERWMS,
            RETORNOEQUIPFISCAL,
            SEQCARGA,
            SERIEGUIA,
            SERIENFDES,
            SERIENFSE,
            SERIENOTA,
            SITESPECIALRESP,
            SITUACAOCTE,
            SITUACAONFCOM,
            SOMDESPADUNFENAC,
            SOMICMSNFENAC,
            SOMPISCOFNFENAC,
            STATUSCFE,
            STATUSCTE,
            STATUSNFCOM,
            STATUSNFE,
            STATUSNFSE,
            STATUSNOTA,
            SUMVLRIIOUTNOTA,
            TERMACORDNOTA,
            TIMCONTRATOLTV,
            TIMCONTRATOVENDA,
            TIMNUFINORIG,
            TIMNUNOTAMOD,
            TIMORIGEM,
            TIPCLIENTESERVCOM,
            TIPFRETE,
            TIPIPIEMB,
            TIPMOV,
            TIPNOTAPMB,
            TIPOGUIA,
            TIPOPTAGJNFE,
            TIPPROCIMP,
            TOTALCUSTOPROD,
            TOTALCUSTOSERV,
            TOTDISPDESC,
            TPAMBCTE,
            TPAMBNFCOM,
            TPAMBNFE,
            TPAMBNFSE,
            TPASSINANTE,
            TPEMISCTE,
            TPEMISNFCOM,
            TPEMISNFE,
            TPEMISNFSE,
            TPFRETAMENTO,
            TPLIGACAO,
            TPRETISS,
            TROCO,
            UFADQUIRENTE,
            UFEMBARQ,
            UFEMISS,
            UFEMISSAO,
            UFVEICULO,
            VALORDESONPISCOFINS,
            VENCFRETE,
            VENCIPI,
            VIATRANSP,
            VLRAFRMM,
            VLRCARGAAVERB,
            VLRCOFINS,
            VLRCOFINSST,
            VLRDESCPARCERIA,
            VLRDESCSERV,
            VLRDESCTOT,
            VLRDESCTOTITEM,
            VLRDESCTOTITEMMOE,
            VLRDESTAQUE,
            VLREMB,
            VLRFETHAB,
            VLRFRETE,
            VLRFRETECALC,
            VLRFRETECPL,
            VLRFRETETOTAL,
            VLRICMS,
            VLRICMSAT,
            VLRICMSDIFALDEST,
            VLRICMSDIFALREM,
            VLRICMSEMB,
            VLRICMSFCP,
            VLRICMSFCPINT,
            VLRICMSSEG,
            VLRINDENIZ,
            VLRINDENIZDIST,
            VLRINSS,
            VLRIPI,
            VLRIRF,
            VLRISS,
            VLRJURO,
            VLRJURODIST,
            VLRLIQITEMNFE,
            VLRMERCADORIA,
            VLRMOEDA,
            VLRNOTA,
            VLROUTROS,
            VLRPIS,
            VLRPISST,
            VLRPRESTAFRMM,
            VLRREPREDST,
            VLRREPREDTOT,
            VLRREPREDTOTSEMDESC,
            VLRREPTERC,
            VLRROYALT,
            VLRSEG,
            VLRSTEXTRANOTATOT,
            VLRSTFCPINT,
            VLRSTFCPINTANT,
            VLRSUBST,
            VLRTOTLIQITEMMOE,
            VLRVENDOR,
            VOLUME
        ) 
        SELECT
            CAB.AD_ABAMERCOS,            
            CAB.AD_ABATERDEVOLUCAO,
            CAB.AD_CODLOCALIVT,
            NULL AD_CONTAGEM,
            CAB.AD_CONTP,
            CAB.AD_DHCONFIRMVDY,
            CAB.AD_DHCRIACAOVDY,
            NULL AD_DTCONTAGEM,
            NULL AD_DTFATURAMENTO,
            CAB.AD_IDSHOPEE,
            CAB.AD_ISAID,
            CAB.AD_ISAORDERNUMBER,
            CAB.AD_MKP_CODPED,
            CAB.AD_MKP_DESTINO,            
            TO_DATE(P_DTSEPARACAO,'YYYY-MM-DD HH24:MI:SS') AD_MKP_DHSEPARACAO,
            TO_DATE(P_DTFATURADO,'YYYY-MM-DD HH24:MI:SS') AD_MKP_DHCHECKOUT,
            CAB.AD_MKP_ID,
            P_IDNFE AD_MKP_IDNFE,
            P_IDSEPARACAO AD_MKP_IDSEPARACAO,
            CAB.AD_MKP_NUMPED,
            CAB.AD_MKP_ORIGEM,
            CAB.AD_NUMCONTRATO,
            CAB.AD_NUMLAT,
            CAB.AD_NUMLONG,
            CAB.AD_NUNOTACONVERSAO,
            CAB.AD_NUVIDYA,
            CAB.AD_OBSFISCO,
            CAB.AD_OFFLINE,
            CAB.AD_TAXASHOPEE,
            CAB.AD_VDYORIG,
            CAB.AGRUPFINNOTA,
            CAB.ALIQIRF,
            CAB.ANTT,
            CAB.APROVADO,
            CAB.BASECOFINS,
            CAB.BASECOFINSST,
            CAB.BASEICMS,
            CAB.BASEICMSAT,
            CAB.BASEICMSFRETE,
            CAB.BASEICMSSTFRETE,
            CAB.BASEINSS,
            CAB.BASEIPI,
            CAB.BASEIRF,
            CAB.BASEISS,
            CAB.BASEPIS,
            CAB.BASEPISST,
            CAB.BASESUBSTIT,
            CAB.BASESUBSTSEMRED,
            CAB.CARACAD,
            CAB.CARACSER,
            CAB.CHAVECTE,
            CAB.CHAVECTEREF,
            CAB.CHAVENFCOM,
            CAB.CHAVENFE,
            CAB.CHAVENFEREF,
            CAB.CHAVENFSE,
            CAB.CHAVESINIEF1324,
            CAB.CHVNFEINEREF,
            CAB.CIF_FOB,
            CAB.CIOT,
            CAB.CLASCONS,
            CAB.CLASSIFICMS,
            CAB.CLIENTEIDPARCERIA,
            CAB.CNPJADQUIRENTE,
            CAB.CODART,
            CAB.CODCC,
            CAB.CODCENCUS,
            CAB.CODCHECKOUT,
            CAB.CODCID,
            CAB.CODCIDDESTINO,
            CAB.CODCIDENTREGA,
            CAB.CODCIDFIMCTE,
            CAB.CODCIDINICTE,
            CAB.CODCIDORIGEM,
            CAB.CODCIDPREST,
            CAB.CODCONTATO,
            CAB.CODCONTATOENTREGA,
            CAB.CODDOCA,
            CAB.CODDOCARRECAD,
            CAB.CODEMP,
            CAB.CODEMPFUNC,
            CAB.CODEMPNEGOC,
            CAB.CODFUNC,
            CAB.CODGRUPOTENSAO,
            CAB.CODGUF,
            CAB.CODINTERM,
            CAB.CODMAQ,
            CAB.CODMODDOCNOTA,
            CAB.CODMOEDA,
            CAB.CODMOTORISTA,
            CAB.CODNAT,
            CAB.CODOBRA,
            CAB.CODOBSPADRAO,
            CAB.CODPARC,
            CAB.CODPARCCONSIGNATARIO,
            CAB.CODPARCDESCARGAMDFE,
            CAB.CODPARCDEST,
            CAB.CODPARCREDESPACHO,
            CAB.CODPARCREMETENTE,
            CAB.CODPARCRETIRADA,
            CAB.CODPARCTRANSP,
            CAB.CODPARCTRANSPFINAL,
            CAB.CODPROJ,
            CAB.CODRASTREAMENTOECT,
            CAB.CODSITE,
            TOP.CODTIPOPERDESTINO,
            CAB.CODTIPVENDA,
            CAB.CODTPD,
            CAB.CODUFDESTINO,
            CAB.CODUFENTREGA,
            CAB.CODUFORIGEM,
            CAB.CODUSU,
            CAB.CODUSUCOMPRADOR,
            CAB.CODUSUINC,
            CAB.CODVEICULO,
            CAB.CODVEND,
            CAB.CODVENDTEC,
            CAB.CODVTP,
            CAB.COMGER,
            CAB.COMISSAO,
            CAB.CONFIRMNOTAFAT,
            CAB.CPFCNPJADQUIRENTE,
            CAB.CPFRESPTEC,
            CAB.CTEGLOBAL,
            CAB.CTELOTACAO,
            CAB.DANFE,
            CAB.DHEMISSEPEC,
            CAB.DHPROTOC,
            CAB.DHPROTOCCTE,
            CAB.DHREGDPEC,
            DESTOP.DHALTER DHTIPOPER,
            TPV.DHALTER DHTIPVENDA,
            CAB.DHVIAGEM,
            CAB.DIGITAL,
            CAB.DIRECAOVIAG,
            CAB.DISDESAUTIMPEMB,
            CAB.DTADIAM,
            SYSDATE DTALTER,
            CAB.DTCONTAB,
            CAB.DTDECLARA,
            TRUNC(SYSDATE) DTENTSAI,
            CAB.DTENTSAIINFO,
            CAB.DTENVIOPMB,
            CAB.DTENVSUF,
            CAB.DTESCRCONT,
            TO_DATE(P_DTFATURADO,'YYYY-MM-DD HH24:MI:SS') DTFATUR,
            TRUNC(SYSDATE) DTMOV,
            TRUNC(TO_DATE(P_DTFATURADO,'YYYY-MM-DD HH24:MI:SS')) DTNEG,
            CAB.DTPREVENT,
            CAB.DTREF,
            CAB.DTREF2,
            CAB.DTREF3,
            CAB.DTREMRET,
            CAB.DTVAL,
            CAB.EXIGEISSQN,
            CAB.FISTEL,
            CAB.FORMPGTCTE,
            CAB.FRETEVLRPAGO,
            CAB.FUSOEMISSEPEC,
            CAB.HISTCONFIG,
            CAB.HRADIAM,
            SYSDATE HRENTSAI,
            TO_NUMBER(TO_CHAR(SYSDATE,'HH24MISS')) HRMOV,
            CAB.ICMSFRETE,
            CAB.ICMSSTFRETE,
            CAB.IDBALSA01,
            CAB.IDBALSA02,
            CAB.IDBALSA03,
            CAB.IDDESCPARCERIA,
            CAB.IDIPROC,
            CAB.IDNAVIO,
            CAB.IDPONTUACAOPARCERIA,
            0 INDNEGMODAL,
            CAB.INDPRESNFCE,
            CAB.INTERMED,
            CAB.IPIEMB,
            DESTOP.TEMIRF IRFRETIDO,
            CAB.IRINNAVIO,
            DESTOP.TEMISS ISSRETIDO,
            CAB.KMVEICULO,
            CAB.LACRES,
            CAB.LATITUDE,
            CAB.LIBCONF,
            CAB.LOCALCOLETA,
            CAB.LOCALENTREGA,
            CAB.LOCEMBARQ,
            CAB.LONGITUDE,
            CAB.LOTACAO,
            CAB.M3,
            CAB.MARCA,
            CAB.MD5MODCOMTEL,
            CAB.MODELONFDES,
            CAB.MODENTREGA,
            CAB.MODRECEBPDVWEB,
            CAB.MOTNAORETERISSQN,
            CAB.NATUREZAOPERDES,
            CAB.NFEDEVRECUSA,
            CAB.NFSEID,
            CAB.NOMEADQUIRENTE,
            CAB.NOTAEMPENHO,
            CAB.NOTAPORPEDIDOPDV,
            CAB.NOTASCF,
            CAB.NROCAIXA,
            CAB.NROREDZ,
            CAB.NUCFR,
            CAB.NUCONFATUAL,
            CAB.NUFOP,
            CAB.NULOTECTE,
            CAB.NULOTENFCOM,
            CAB.NULOTENFE,
            CAB.NULOTENFSE,
            CAB.NUMALEATORIO,
            CAB.NUMALEATORIOCTE,
            CAB.NUMCF,
            CAB.NUMCONTRATO,
            CAB.NUMCOTACAO,
            CAB.NUMCSTC,
            CAB.NUMDOCARRECAD,
            CAB.NUMERACAOVOLUMES,
            CAB.NUMGUIA,
            CAB.NUMNFSE,
            P_NUMNFE NUMNOTA,
            CAB.NUMOS,
            CAB.NUMPEDIDO2,
            CAB.NUMPROTOC,
            CAB.NUMPROTOCCTE,
            CAB.NUMPROTOCINCTE,
            CAB.NUMPROTOCINNFE,
            CAB.NUMPROTOCNFCOM,
            CAB.NUMRECEITAGRO,
            CAB.NUMREGDPEC,
            CAB.NUMTERMTEL,
            V_NUNOTA_NOTA NUNOTA,
            CAB.NUNOTAPEDFRET,
            CAB.NUNOTAREC,
            CAB.NUNOTASUB,
            CAB.NUODP,
            CAB.NUPCA,
            CAB.NUPEDFRETE,
            CAB.NURD8,
            CAB.NURECEBIMENTO,
            CAB.NUREM,
            CAB.NUSESSAO,
            CAB.NUTRANSF,
            CAB.OBSERVACAO,
            CAB.OCCN48,
            CAB.ORDEMCARGA,
            CAB.PENDENTE,
            CAB.PERCDESC,
            CAB.PERCDESCFOB,
            CAB.PERMALTERCENTRAL,
            CAB.PESO,
            CAB.PESOBRUTO,
            CAB.PESOBRUTOMANUAL,
            CAB.PESOLIQUIMANUAL,
            CAB.PLACA,
            CAB.PREMIACAOESTADUAL,
            CAB.PRODPRED,
            CAB.PRODUETLOC,
            CAB.QTDUSU,
            CAB.QTDVOL,
            CAB.RATEADO,
            CAB.REBOQUE1,
            CAB.REBOQUE2,
            CAB.REBOQUE3,
            CAB.REGESPTRIBUT,
            CAB.RETGERWMS,
            CAB.RETORNOEQUIPFISCAL,
            CAB.SEQCARGA,
            CAB.SERIEGUIA,
            CAB.SERIENFDES,
            CAB.SERIENFSE,
            NVL(V_SERIE_NOTA,1) SERIENOTA,
            CAB.SITESPECIALRESP,
            CAB.SITUACAOCTE,
            CAB.SITUACAONFCOM,
            CAB.SOMDESPADUNFENAC,
            CAB.SOMICMSNFENAC,
            CAB.SOMPISCOFNFENAC,
            CAB.STATUSCFE,
            CAB.STATUSCTE,
            CAB.STATUSNFCOM,
            CAB.STATUSNFE,
            CAB.STATUSNFSE,
            'P' STATUSNOTA,
            CAB.SUMVLRIIOUTNOTA,
            CAB.TERMACORDNOTA,
            CAB.TIMCONTRATOLTV,
            CAB.TIMCONTRATOVENDA,
            CAB.TIMNUFINORIG,
            CAB.TIMNUNOTAMOD,
            CAB.TIMORIGEM,
            CAB.TIPCLIENTESERVCOM,
            CAB.TIPFRETE,
            CAB.TIPIPIEMB,
            DESTOP.TIPMOV,
            CAB.TIPNOTAPMB,
            CAB.TIPOGUIA,
            CAB.TIPOPTAGJNFE,
            CAB.TIPPROCIMP,
            CAB.TOTALCUSTOPROD,
            CAB.TOTALCUSTOSERV,
            CAB.TOTDISPDESC,
            CAB.TPAMBCTE,
            CAB.TPAMBNFCOM,
            CAB.TPAMBNFE,
            CAB.TPAMBNFSE,
            CAB.TPASSINANTE,
            CAB.TPEMISCTE,
            CAB.TPEMISNFCOM,
            CAB.TPEMISNFE,
            CAB.TPEMISNFSE,
            CAB.TPFRETAMENTO,
            CAB.TPLIGACAO,
            CAB.TPRETISS,
            CAB.TROCO,
            CAB.UFADQUIRENTE,
            CAB.UFEMBARQ,
            CAB.UFEMISS,
            CAB.UFEMISSAO,
            CAB.UFVEICULO,
            CAB.VALORDESONPISCOFINS,
            CAB.VENCFRETE,
            CAB.VENCIPI,
            CAB.VIATRANSP,
            CAB.VLRAFRMM,
            CAB.VLRCARGAAVERB,
            CAB.VLRCOFINS,
            CAB.VLRCOFINSST,
            CAB.VLRDESCPARCERIA,
            CAB.VLRDESCSERV,
            CAB.VLRDESCTOT,
            CAB.VLRDESCTOTITEM,
            CAB.VLRDESCTOTITEMMOE,
            CAB.VLRDESTAQUE,
            CAB.VLREMB,
            CAB.VLRFETHAB,
            CAB.VLRFRETE,
            CAB.VLRFRETECALC,
            CAB.VLRFRETECPL,
            CAB.VLRFRETETOTAL,
            CAB.VLRICMS,
            CAB.VLRICMSAT,
            CAB.VLRICMSDIFALDEST,
            CAB.VLRICMSDIFALREM,
            CAB.VLRICMSEMB,
            CAB.VLRICMSFCP,
            CAB.VLRICMSFCPINT,
            CAB.VLRICMSSEG,
            CAB.VLRINDENIZ,
            CAB.VLRINDENIZDIST,
            CAB.VLRINSS,
            CAB.VLRIPI,
            CAB.VLRIRF,
            CAB.VLRISS,
            CAB.VLRJURO,
            CAB.VLRJURODIST,
            CAB.VLRLIQITEMNFE,
            CAB.VLRMERCADORIA,
            CAB.VLRMOEDA,
            CAB.VLRNOTA,
            CAB.VLROUTROS,
            CAB.VLRPIS,
            CAB.VLRPISST,
            CAB.VLRPRESTAFRMM,
            CAB.VLRREPREDST,
            CAB.VLRREPREDTOT,
            CAB.VLRREPREDTOTSEMDESC,
            CAB.VLRREPTERC,
            CAB.VLRROYALT,
            CAB.VLRSEG,
            CAB.VLRSTEXTRANOTATOT,
            CAB.VLRSTFCPINT,
            CAB.VLRSTFCPINTANT,
            CAB.VLRSUBST,
            CAB.VLRTOTLIQITEMMOE,
            CAB.VLRVENDOR,
            CAB.VOLUME
        FROM TGFCAB CAB
            INNER JOIN TGFTOP TOP    ON CAB.CODTIPOPER = TOP.CODTIPOPER AND CAB.DHTIPOPER = TOP.DHALTER
            INNER JOIN TGFTOP DESTOP ON DESTOP.CODTIPOPER = TOP.CODTIPOPERDESTINO AND DESTOP.DHALTER = (SELECT MAX(DHALTER) FROM TGFTOP AUXTOP WHERE AUXTOP.CODTIPOPER = DESTOP.CODTIPOPER AND TRUNC(AUXTOP.DHALTER) <= TRUNC(TO_DATE(P_DTSEPARACAO,'YYYY-MM-DD HH24:MI:SS')))
            INNER JOIN TGFTPV TPV    ON CAB.CODTIPVENDA = TPV.CODTIPVENDA AND CAB.DHTIPVENDA = TPV.DHALTER
        WHERE CAB.NUNOTA = P_NUNOTA;
    END;

    -- COPIANDO ITENS DO PEDIDO PARA NOTA
    FOR PEDIDO_ITEM IN (SELECT * FROM TGFITE WHERE NUNOTA = P_NUNOTA) LOOP
        BEGIN
            INSERT INTO TGFITE
            (   AD_BLOQPRODPROM,
                AD_CODPRODPROM,
                AD_CODPRODPROMSUB,
                ALIQFETHAB,
                ALIQFUNTTEL,
                ALIQFUST,
                ALIQICMS,
                ALIQICMSAT,
                ALIQICMSRED,
                ALIQINTERICMSAT,
                ALIQIPI,
                ALIQISS,
                ALIQSTEXTRANOTA,
                ALIQSTFCPSTANT,
                ALTPRECO,
                ALTURA,
                ATUALESTOQUE,
                ATUALESTTERC,
                BASECALCSTEXTRANOTA,
                BASEFUNTTEL,
                BASEFUST,
                BASEICMS,
                BASEICMSAT,
                BASEICMSSTFRETE,
                BASEIPI,
                BASEISS,
                BASESTANT,
                BASESTEXTRANOTA,
                BASESTFCPINTANT,
                BASESTUFDEST,
                BASESUBSTIT,
                BASESUBSTITANT,
                BASESUBSTITUNITORIG,
                BASESUBSTSEMRED,
                BASICMMOD,
                BASICMSTMOD,
                CNPJFABRICANTE,
                CODAGREGACAO,
                CODANTECIPST,
                CODBARRAPDV,
                CODBENEFNAUF,
                CODCAV,
                CODCFO,
                CODCFPS,
                CODDOCARRECAD,
                CODEMP,
                CODENQIPI,
                CODESPECST,
                CODEXEC,
                CODFCI,
                CODIGONFCOM,
                CODIPI,
                CODLOCALORIG,
                CODLOCALTERC,
                CODMOTDESONERAICMS,
                CODMOTDESONERAST,
                CODNATREND,
                CODOBSPADRAO,
                CODPARCEXEC,
                CODPROC,
                CODPROD,
                CODPROMO,
                CODSIT08EFD,
                CODTPA,
                CODTRIB,
                CODTRIBISS,
                CODUSU,
                CODVEND,
                CODVOL,
                CODVOLPARC,
                CONTROLE,
                CSOSN,
                CSTIPI,
                CUSTO,
                DTALTER,
                DTINICIO,
                ENDIMAGEM,
                ESPESSURA,
                FATURAR,
                GERAPRODUCAO,
                GRUPOTRANSG,
                GTINNFE,
                GTINTRIBNFE,
                ICMSSTFRETE,
                IDALIQICMS,
                IDALIQICMSAT,
                IDALIQICMSDIFICMS,
                IDALIQISS,
                IDDESCPARCERIA,
                INDDEVOLUCAONFCOM,
                INDESCALA,
                INDREPDES,
                LARGURA,
                M3,
                MARGLUCRO,
                NRSERIERESERVA,
                NUFOP,
                NUMCONTRATO,
                NUMDOCARRECAD,
                NUMEROOS,
                NUMPEDIDO2,
                NUNOTA,
                NUPROMOCAO,
                NUTAB,
                OBSERVACAO,
                ORIGEMBUSCA,
                ORIGPROD,
                PENDENTE,
                PERCCOM,
                PERCCOMGER,
                PERCDESC,
                PERCDESCBASE,
                PERCDESCBONIF,
                PERCDESCDIGITADO,
                PERCDESCFORNECEDOR,
                PERCDESCPROM,
                PERCDESCTGFDES,
                PERCGERMIN,
                PERCPUREZA,
                PERCREDVLRIPI,
                PERCSTFCPINTANT,
                PERCUSAQUDECPE,
                PERCUSAQUDECPEEST,
                PRECOBASE,
                PRECOBASEQTD,
                PRODUTONFE,
                PRODUTOPESQUISADO,
                QTDCONFERIDA,
                QTDENTREGUE,
                QTDFAT,
                QTDFIXADA,
                QTDFORMULA,
                QTDNEG,
                QTDPECA,
                QTDTRIBEXPORT,
                QTDVOL,
                QTDWMS,
                REDBASEST,
                RESERVA,
                SEQPEDIDO2,
                SEQUENCIA,
                SEQUENCIAFISCAL,
                SOLCOMPRA,
                STATUSLOTE,
                STATUSNOTA,
                TERCEIROS,
                TIPENTREGA,
                TIPOSEPARACAO,
                TIPUTILCOM,
                UNIDADE,
                USOPROD,
                VARIACAOFCP,
                VLRACRESCDESC,
                VLRCOM,
                VLRCOMGER,
                VLRCUS,
                VLRCUSAQUDECPE,
                VLRDESC,
                VLRDESCBONIF,
                VLRDESCDIGITADO,
                VLRDESCMOE,
                VLRDESCPARCERIA,
                VLRFETHAB,
                VLRFUNTTEL,
                VLRFUST,
                VLRICMS,
                VLRICMSANT,
                VLRICMSAT,
                VLRICMSDIFERIDO,
                VLRICMSUFDEST,
                VLRIPI,
                VLRISS,
                VLRLIQPROM,
                VLRPROMO,
                VLRPTOPUREZA,
                VLRREPRED,
                VLRREPREDSEMDESC,
                VLRREPREDST,
                VLRRETENCAO,
                VLRSTEXTRANOTA,
                VLRSTFCPINTANT,
                VLRSUBST,
                VLRSUBSTANT,
                VLRSUBSTUNITORIG,
                VLRTOT,
                VLRTOTMOE,
                VLRTROCA,
                VLRUNIT,
                VLRUNITDOLAR,
                VLRUNITLOC,
                VLRUNITMOE,
                VLRVENDAPROMO
            ) VALUES (
                PEDIDO_ITEM.AD_BLOQPRODPROM,
                PEDIDO_ITEM.AD_CODPRODPROM,
                PEDIDO_ITEM.AD_CODPRODPROMSUB,
                PEDIDO_ITEM.ALIQFETHAB,
                PEDIDO_ITEM.ALIQFUNTTEL,
                PEDIDO_ITEM.ALIQFUST,
                PEDIDO_ITEM.ALIQICMS,
                PEDIDO_ITEM.ALIQICMSAT,
                PEDIDO_ITEM.ALIQICMSRED,
                PEDIDO_ITEM.ALIQINTERICMSAT,
                PEDIDO_ITEM.ALIQIPI,
                PEDIDO_ITEM.ALIQISS,
                PEDIDO_ITEM.ALIQSTEXTRANOTA,
                PEDIDO_ITEM.ALIQSTFCPSTANT,
                PEDIDO_ITEM.ALTPRECO,
                PEDIDO_ITEM.ALTURA,
                -1, -- ATUALESTOQUE
                PEDIDO_ITEM.ATUALESTTERC,
                PEDIDO_ITEM.BASECALCSTEXTRANOTA,
                PEDIDO_ITEM.BASEFUNTTEL,
                PEDIDO_ITEM.BASEFUST,
                PEDIDO_ITEM.BASEICMS,
                PEDIDO_ITEM.BASEICMSAT,
                PEDIDO_ITEM.BASEICMSSTFRETE,
                PEDIDO_ITEM.BASEIPI,
                PEDIDO_ITEM.BASEISS,
                PEDIDO_ITEM.BASESTANT,
                PEDIDO_ITEM.BASESTEXTRANOTA,
                PEDIDO_ITEM.BASESTFCPINTANT,
                PEDIDO_ITEM.BASESTUFDEST,
                PEDIDO_ITEM.BASESUBSTIT,
                PEDIDO_ITEM.BASESUBSTITANT,
                PEDIDO_ITEM.BASESUBSTITUNITORIG,
                PEDIDO_ITEM.BASESUBSTSEMRED,
                PEDIDO_ITEM.BASICMMOD,
                PEDIDO_ITEM.BASICMSTMOD,
                PEDIDO_ITEM.CNPJFABRICANTE,
                PEDIDO_ITEM.CODAGREGACAO,
                PEDIDO_ITEM.CODANTECIPST,
                PEDIDO_ITEM.CODBARRAPDV,
                PEDIDO_ITEM.CODBENEFNAUF,
                PEDIDO_ITEM.CODCAV,
                PEDIDO_ITEM.CODCFO,
                PEDIDO_ITEM.CODCFPS,
                PEDIDO_ITEM.CODDOCARRECAD,
                PEDIDO_ITEM.CODEMP,
                PEDIDO_ITEM.CODENQIPI,
                PEDIDO_ITEM.CODESPECST,
                PEDIDO_ITEM.CODEXEC,
                PEDIDO_ITEM.CODFCI,
                PEDIDO_ITEM.CODIGONFCOM,
                PEDIDO_ITEM.CODIPI,
                PEDIDO_ITEM.CODLOCALORIG,
                PEDIDO_ITEM.CODLOCALTERC,
                PEDIDO_ITEM.CODMOTDESONERAICMS,
                PEDIDO_ITEM.CODMOTDESONERAST,
                PEDIDO_ITEM.CODNATREND,
                PEDIDO_ITEM.CODOBSPADRAO,
                PEDIDO_ITEM.CODPARCEXEC,
                PEDIDO_ITEM.CODPROC,
                PEDIDO_ITEM.CODPROD,
                PEDIDO_ITEM.CODPROMO,
                'N', -- CODSIT08EFD
                PEDIDO_ITEM.CODTPA,
                PEDIDO_ITEM.CODTRIB,
                PEDIDO_ITEM.CODTRIBISS,
                PEDIDO_ITEM.CODUSU,
                PEDIDO_ITEM.CODVEND,
                PEDIDO_ITEM.CODVOL,
                PEDIDO_ITEM.CODVOLPARC,
                PEDIDO_ITEM.CONTROLE,
                PEDIDO_ITEM.CSOSN,
                PEDIDO_ITEM.CSTIPI,
                PEDIDO_ITEM.CUSTO,
                SYSDATE, -- DTALTER
                PEDIDO_ITEM.DTINICIO,
                PEDIDO_ITEM.ENDIMAGEM,
                PEDIDO_ITEM.ESPESSURA,
                PEDIDO_ITEM.FATURAR,
                PEDIDO_ITEM.GERAPRODUCAO,
                PEDIDO_ITEM.GRUPOTRANSG,
                PEDIDO_ITEM.GTINNFE,
                PEDIDO_ITEM.GTINTRIBNFE,
                PEDIDO_ITEM.ICMSSTFRETE,
                PEDIDO_ITEM.IDALIQICMS,
                PEDIDO_ITEM.IDALIQICMSAT,
                PEDIDO_ITEM.IDALIQICMSDIFICMS,
                PEDIDO_ITEM.IDALIQISS,
                PEDIDO_ITEM.IDDESCPARCERIA,
                PEDIDO_ITEM.INDDEVOLUCAONFCOM,
                PEDIDO_ITEM.INDESCALA,
                PEDIDO_ITEM.INDREPDES,
                PEDIDO_ITEM.LARGURA,
                PEDIDO_ITEM.M3,
                PEDIDO_ITEM.MARGLUCRO,
                PEDIDO_ITEM.NRSERIERESERVA,
                PEDIDO_ITEM.NUFOP,
                PEDIDO_ITEM.NUMCONTRATO,
                PEDIDO_ITEM.NUMDOCARRECAD,
                PEDIDO_ITEM.NUMEROOS,
                PEDIDO_ITEM.NUMPEDIDO2,
                V_NUNOTA_NOTA, -- NUNOTA
                PEDIDO_ITEM.NUPROMOCAO,
                PEDIDO_ITEM.NUTAB,
                PEDIDO_ITEM.OBSERVACAO,
                PEDIDO_ITEM.ORIGEMBUSCA,
                PEDIDO_ITEM.ORIGPROD,
                PEDIDO_ITEM.PENDENTE,
                PEDIDO_ITEM.PERCCOM,
                PEDIDO_ITEM.PERCCOMGER,
                PEDIDO_ITEM.PERCDESC,
                PEDIDO_ITEM.PERCDESCBASE,
                PEDIDO_ITEM.PERCDESCBONIF,
                PEDIDO_ITEM.PERCDESCDIGITADO,
                PEDIDO_ITEM.PERCDESCFORNECEDOR,
                PEDIDO_ITEM.PERCDESCPROM,
                PEDIDO_ITEM.PERCDESCTGFDES,
                PEDIDO_ITEM.PERCGERMIN,
                PEDIDO_ITEM.PERCPUREZA,
                PEDIDO_ITEM.PERCREDVLRIPI,
                PEDIDO_ITEM.PERCSTFCPINTANT,
                PEDIDO_ITEM.PERCUSAQUDECPE,
                PEDIDO_ITEM.PERCUSAQUDECPEEST,
                PEDIDO_ITEM.PRECOBASE,
                PEDIDO_ITEM.PRECOBASEQTD,
                PEDIDO_ITEM.PRODUTONFE,
                PEDIDO_ITEM.PRODUTOPESQUISADO,
                PEDIDO_ITEM.QTDCONFERIDA,
                PEDIDO_ITEM.QTDENTREGUE,
                PEDIDO_ITEM.QTDFAT,
                PEDIDO_ITEM.QTDFIXADA,
                PEDIDO_ITEM.QTDFORMULA,
                PEDIDO_ITEM.QTDNEG,
                PEDIDO_ITEM.QTDPECA,
                PEDIDO_ITEM.QTDTRIBEXPORT,
                PEDIDO_ITEM.QTDVOL,
                PEDIDO_ITEM.QTDWMS,
                PEDIDO_ITEM.REDBASEST,
                'N', -- RESERVA
                PEDIDO_ITEM.SEQPEDIDO2,
                PEDIDO_ITEM.SEQUENCIA,
                PEDIDO_ITEM.SEQUENCIAFISCAL,
                'N', -- SOLCOMPRA
                'N', -- STATUSLOTE
                'A', -- STATUSNOTA
                PEDIDO_ITEM.TERCEIROS,
                PEDIDO_ITEM.TIPENTREGA,
                PEDIDO_ITEM.TIPOSEPARACAO,
                PEDIDO_ITEM.TIPUTILCOM,
                PEDIDO_ITEM.UNIDADE,
                PEDIDO_ITEM.USOPROD,
                PEDIDO_ITEM.VARIACAOFCP,
                PEDIDO_ITEM.VLRACRESCDESC,
                PEDIDO_ITEM.VLRCOM,
                PEDIDO_ITEM.VLRCOMGER,
                PEDIDO_ITEM.VLRCUS,
                PEDIDO_ITEM.VLRCUSAQUDECPE,
                PEDIDO_ITEM.VLRDESC,
                PEDIDO_ITEM.VLRDESCBONIF,
                PEDIDO_ITEM.VLRDESCDIGITADO,
                PEDIDO_ITEM.VLRDESCMOE,
                PEDIDO_ITEM.VLRDESCPARCERIA,
                PEDIDO_ITEM.VLRFETHAB,
                PEDIDO_ITEM.VLRFUNTTEL,
                PEDIDO_ITEM.VLRFUST,
                PEDIDO_ITEM.VLRICMS,
                PEDIDO_ITEM.VLRICMSANT,
                PEDIDO_ITEM.VLRICMSAT,
                PEDIDO_ITEM.VLRICMSDIFERIDO,
                PEDIDO_ITEM.VLRICMSUFDEST,
                PEDIDO_ITEM.VLRIPI,
                PEDIDO_ITEM.VLRISS,
                PEDIDO_ITEM.VLRLIQPROM,
                PEDIDO_ITEM.VLRPROMO,
                PEDIDO_ITEM.VLRPTOPUREZA,
                PEDIDO_ITEM.VLRREPRED,
                PEDIDO_ITEM.VLRREPREDSEMDESC,
                PEDIDO_ITEM.VLRREPREDST,
                PEDIDO_ITEM.VLRRETENCAO,
                PEDIDO_ITEM.VLRSTEXTRANOTA,
                PEDIDO_ITEM.VLRSTFCPINTANT,
                PEDIDO_ITEM.VLRSUBST,
                PEDIDO_ITEM.VLRSUBSTANT,
                PEDIDO_ITEM.VLRSUBSTUNITORIG,
                PEDIDO_ITEM.VLRTOT,
                PEDIDO_ITEM.VLRTOTMOE,
                PEDIDO_ITEM.VLRTROCA,
                PEDIDO_ITEM.VLRUNIT,
                PEDIDO_ITEM.VLRUNITDOLAR,
                PEDIDO_ITEM.VLRUNITLOC,
                PEDIDO_ITEM.VLRUNITMOE,
                PEDIDO_ITEM.VLRVENDAPROMO   
            );
        END;
    END LOOP;

    -- CRIANDO VINCULO PEDIDO X NOTA
    FOR PEDIDO_VIN IN (SELECT NUNOTA, SEQUENCIA, QTDNEG FROM TGFITE WHERE NUNOTA = V_NUNOTA_NOTA) LOOP
        BEGIN
            INSERT INTO TGFVAR (
                NUNOTA,
                NUNOTAORIG,
                QTDATENDIDA,
                SEQUENCIA,
                SEQUENCIAORIG,
                STATUSNOTA
            ) VALUES (
                PEDIDO_VIN.NUNOTA,
                P_NUNOTA,
                PEDIDO_VIN.QTDNEG,
                PEDIDO_VIN.SEQUENCIA,
                PEDIDO_VIN.SEQUENCIA,
                'P'
            );
        END;
    END LOOP; 

    -- LANÇANDO O FINANCEIRO DA NOTA
    FOR PEDIDO_FIN IN ( 
        SELECT
            FIN.ABATIMENTO,
            FIN.ABATIMENTOCAN,
            FIN.AD_CHAVEPIX,
            FIN.AD_COBRANCATERC,
            FIN.AD_CODCONTA,
            FIN.AD_CODIGORECEITA,
            FIN.AD_DARFAPURACAO,
            FIN.AD_DARFCODREC,
            FIN.AD_DARFNUMREF,
            FIN.AD_DTINCPDD,
            FIN.AD_FGTSCODREC,
            FIN.AD_FGTSDIGLACRE,
            FIN.AD_FGTSINDICADOR,
            FIN.AD_FGTSNUMLACRE,
            FIN.AD_FORMALANCPIX,
            FIN.AD_GPSATUALMONET,
            FIN.AD_GPSCODPAGTO,
            FIN.AD_GPSCOMPETENCIA,
            FIN.AD_GPSVLRARREC,
            FIN.AD_GPSVLRINSS,
            FIN.AD_GPSVLROUTENT,
            FIN.AD_IDENTPIX,
            FIN.AD_INFPIX,
            FIN.AD_NUMCONTRATO,
            FIN.AD_NUMEROREFERENCIA,
            FIN.AD_PERIODOAPURACAO,
            FIN.AD_TAXASHOPEE,
            FIN.AD_TIPLANPIX,
            FIN.AD_TXID,
            FIN.AGENCIA_CMC7,
            FIN.ALIQICMS,
            FIN.AUTORIZADO,
            FIN.BAIXAAPI,
            FIN.BASEICMS,
            FIN.BASEINSS,
            FIN.BASEIRF,
            FIN.BLOQVAR,
            FIN.CARTA,
            FIN.CARTAODESC,
            FIN.CGC_CPF_CMC7,
            FIN.CHAVECTE,
            FIN.CHAVECTEREF,
            FIN.CHAVENFEGNRE,
            FIN.CHEQUERASTREADO_CMC7,
            FIN.CLASSIFCESSAOOBRA,
            FIN.CODBARRA,
            FIN.CODBCO,
            FIN.CODBCO_CMC7,
            FIN.CODCBE,
            FIN.CODCC,
            FIN.CODCENCUS,
            FIN.CODCFO,
            FIN.CODCIDFIMCTE,
            FIN.CODCIDINICTE,
            FIN.CODCONTATO,
            FIN.CODCTABCOINT,
            FIN.CODEMP,
            FIN.CODEMPBAIXA,
            FIN.CODFUNC,
            FIN.CODIGOBARRA,
            FIN.CODIMOVELRURAL,
            FIN.CODIPTU,
            FIN.CODLST,
            FIN.CODMOEDA,
            FIN.CODNAT,
            FIN.CODOBRA,
            FIN.CODOBSPADRAO,
            FIN.CODPARC,
            FIN.CODPROJ,
            FIN.CODRECEITA,
            FIN.CODREGUA,
            CAB.CODTIPOPER,
            FIN.CODTIPOPERBAIXA,
            FIN.CODTIPTIT,
            FIN.CODTRIB,
            FIN.CODUSU,
            FIN.CODUSUBAIXA,
            FIN.CODUSUCOBR,
            FIN.CODVEICULO,
            FIN.CODVEND,
            FIN.CONTA_CMC7,
            FIN.CUSTASPROCESSUAIS,
            FIN.DEPOSITOJUDICIAL,
            FIN.DESCRTPAGNFCE,
            FIN.DESDOBDUPL,
            FIN.DESDOBRAMENTO,
            FIN.DESPADVOGADO,
            FIN.DESPCART,
            NULL DHBAIXA,
            FIN.DHMOV,
            CAB.DHTIPOPER,
            FIN.DHTIPOPERBAIXA,
            FIN.DH_IMPRESSAO,
            FIN.DIGSAFRA,
            SYSDATE DTALTER,
            FIN.DTBAIXAPREV,
            FIN.DTCONTAB,
            FIN.DTCONTABBAIXA,
            CAB.DTENTSAI,
            FIN.DTENTSAIINFO,
            FIN.DTINITREFAPURACAO,
            FIN.DTINTEGRACAOIPI,
            CAB.DTNEG,
            FIN.DTPRAZO,
            FIN.DTREFERENCIA,
            FIN.DTVENC,
            FIN.DTVENCINIC,
            FIN.EMVPIX,
            FIN.EXIGEISSQN,
            FIN.HISTORICO,
            FIN.IDLOTEFDIC,
            FIN.IDUNICO,
            FIN.INDRECEFDCONT,
            FIN.INFCOMPLEFDCONT,
            FIN.INSSRETIDO,
            FIN.IRFRETIDO,
            FIN.ISSRETIDO,
            FIN.JUROSAVP,
            FIN.LINHADIGITAVEL,
            FIN.M2,
            FIN.METODOCALCIRRF,
            FIN.MODELONFDES,
            FIN.MONIOCOREM,
            FIN.MOTNAORETERISSQN,
            FIN.NATUREZAOPERDES,
            FIN.NFCOMPLFIX,
            FIN.NFENTSEQFIX,
            FIN.NOMEEMITENTE_CMC7,
            FIN.NOSSONUM,
            FIN.NROIMPORT,
            FIN.NROLOTEGNRE,
            FIN.NUANTBANC,
            FIN.NUAPONTA,
            FIN.NUBCO,
            FIN.NUCAIXA,
            FIN.NUCCR,
            FIN.NUCHQ,
            FIN.NUCKC,
            FIN.NUCOMPENS,
            FIN.NUDEV,
            FIN.NUFTC,
            FIN.NUMBOR,
            FIN.NUMCONTRATO,
            FIN.NUMDOCARRECAD,
            FIN.NUMDUPL,
            FIN.NUMNFSE,
            CAB.NUMNOTA,
            FIN.NUMOCORRENCIAS,
            FIN.NUMOS,
            FIN.NUMPROCADMJUDIC,
            FIN.NUMREMESSA,
            CAB.NUNOTA,
            FIN.NUPED,
            FIN.NURENEG,
            FIN.NUVERBA,
            FIN.OBRACONSTCIVIL,
            FIN.ORDEMCARGA,
            FIN.ORIGEM,
            FIN.PARCRENEG,
            FIN.PDD,
            FIN.PIXTEF,
            DECODE(TOP.TIPATUALFIN,'P','S','I','N') PROVISAO,
            FIN.RATEADO,
            FIN.RECADIANTAMENTORURAL,
            FIN.RECDESP,
            FIN.RECEBCARTAO,
            FIN.RECEBIDO,
            FIN.REFATCON,
            FIN.REGESPTRIBUT,
            FIN.REJEICAOGNRE,
            FIN.SANGDESPDV,
            FIN.SEQCAIXA,
            FIN.SEQUENCIA,
            FIN.SERIENFDES,
            CAB.SERIENOTA,
            FIN.SITESPECIALRESP,
            FIN.STATUSGNRE,
            FIN.TIMBLOQUEADA,
            FIN.TIMCONTALANC,
            FIN.TIMCONTAREP,
            FIN.TIMCONTRATOADM,
            FIN.TIMCONTRATOLOC,
            FIN.TIMCONTRATOLTV,
            FIN.TIMDATADEJUR,
            FIN.TIMDHBAIXA,
            FIN.TIMDHGERREPASSE,
            FIN.TIMDHGERREPPARCIAL,
            FIN.TIMDTIMPBOL,
            FIN.TIMDTIMPBOLLOCAL,
            FIN.TIMDTREPASSE,
            FIN.TIMDTREPPARCIAL,
            FIN.TIMFECHAMENTO,
            FIN.TIMFECHAMENTOALU,
            FIN.TIMFINGARANTORIG,
            FIN.TIMIMOVEL,
            FIN.TIMNEGOCIACAO,
            FIN.TIMNOMEADVOGADO,
            FIN.TIMNUFINORIG,
            FIN.TIMNUMREG,
            FIN.TIMORIGEM,
            FIN.TIMORIGRENEG,
            FIN.TIMPARCELA,
            FIN.TIMRENEGCANCLOTE,
            FIN.TIMRENEGIMV,
            FIN.TIMRENEGLOTE,
            FIN.TIMREPINTELIGENTE,
            FIN.TIMREPPARCIAL,
            FIN.TIMRESCISAOLOC,
            FIN.TIMRESCISAOLTV,
            FIN.TIMSAC,
            FIN.TIMTIPOINTERMED,
            FIN.TIMTXADMGERALU,
            FIN.TIMVENDAIMV,
            FIN.TIMVENDALOTE,
            FIN.TIMVLRAMORTCONTRATO,
            FIN.TIMVLRCORRMONET,
            FIN.TIMVLRJUROCONTRATO,
            FIN.TIPAPURACAO,
            FIN.TIPJURO,
            FIN.TIPMARCCHEQ,
            FIN.TIPMULTA,
            FIN.TPAGNFCE,
            FIN.TROCOPDV,
            FIN.VALORPRESENTE,
            FIN.VENDAMAIS,
            FIN.VLRALIBERAR,
            0 VLRBAIXA,
            FIN.VLRCESSAO,
            FIN.VLRCHEQUE,
            FIN.VLRDESC,
            FIN.VLRDESCCALC,
            FIN.VLRDESCEMBUT,
            FIN.VLRDESDOB,
            FIN.VLRDESDOBCALC,
            FIN.VLRFATCARTAO,
            FIN.VLRGNREDOIS,
            FIN.VLRICMSXMLCTE,
            FIN.VLRINSS,
            FIN.VLRIRF,
            FIN.VLRISS,
            FIN.VLRJURO,
            FIN.VLRJUROEMBUT,
            FIN.VLRJUROLIB,
            FIN.VLRJURONEGOC,
            FIN.VLRMOEDA,
            FIN.VLRMOEDABAIXA,
            FIN.VLRMULTA,
            FIN.VLRMULTAEMBUT,
            FIN.VLRMULTALIB,
            FIN.VLRMULTANEGOC,
            FIN.VLRPROV,
            FIN.VLRVARCAMBIAL,
            FIN.VLRVENDOR
        FROM TGFFIN FIN
            INNER JOIN TGFVAR VAR ON FIN.NUNOTA = VAR.NUNOTAORIG
            INNER JOIN TGFCAB CAB ON VAR.NUNOTA = CAB.NUNOTA
            INNER JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER AND CAB.DHTIPOPER = TOP.DHALTER
        WHERE FIN.NUNOTA = P_NUNOTA ) LOOP
        BEGIN
            INSERT INTO TGFFIN
            (   ABATIMENTO,
                ABATIMENTOCAN,
                AD_CHAVEPIX,
                AD_COBRANCATERC,
                AD_CODCONTA,
                AD_CODIGORECEITA,
                AD_DARFAPURACAO,
                AD_DARFCODREC,
                AD_DARFNUMREF,
                AD_DTINCPDD,
                AD_FGTSCODREC,
                AD_FGTSDIGLACRE,
                AD_FGTSINDICADOR,
                AD_FGTSNUMLACRE,
                AD_FORMALANCPIX,
                AD_GPSATUALMONET,
                AD_GPSCODPAGTO,
                AD_GPSCOMPETENCIA,
                AD_GPSVLRARREC,
                AD_GPSVLRINSS,
                AD_GPSVLROUTENT,
                AD_IDENTPIX,
                AD_INFPIX,
                AD_NUMCONTRATO,
                AD_NUMEROREFERENCIA,
                AD_PERIODOAPURACAO,
                AD_TAXASHOPEE,
                AD_TIPLANPIX,
                AD_TXID,
                AGENCIA_CMC7,
                ALIQICMS,
                AUTORIZADO,
                BAIXAAPI,
                BASEICMS,
                BASEINSS,
                BASEIRF,
                BLOQVAR,
                CARTA,
                CARTAODESC,
                CGC_CPF_CMC7,
                CHAVECTE,
                CHAVECTEREF,
                CHAVENFEGNRE,
                CHEQUERASTREADO_CMC7,
                CLASSIFCESSAOOBRA,
                CODBARRA,
                CODBCO,
                CODBCO_CMC7,
                CODCBE,
                CODCC,
                CODCENCUS,
                CODCFO,
                CODCIDFIMCTE,
                CODCIDINICTE,
                CODCONTATO,
                CODCTABCOINT,
                CODEMP,
                CODEMPBAIXA,
                CODFUNC,
                CODIGOBARRA,
                CODIMOVELRURAL,
                CODIPTU,
                CODLST,
                CODMOEDA,
                CODNAT,
                CODOBRA,
                CODOBSPADRAO,
                CODPARC,
                CODPROJ,
                CODRECEITA,
                CODREGUA,
                CODTIPOPER,
                CODTIPOPERBAIXA,
                CODTIPTIT,
                CODTRIB,
                CODUSU,
                CODUSUBAIXA,
                CODUSUCOBR,
                CODVEICULO,
                CODVEND,
                CONTA_CMC7,
                CUSTASPROCESSUAIS,
                DEPOSITOJUDICIAL,
                DESCRTPAGNFCE,
                DESDOBDUPL,
                DESDOBRAMENTO,
                DESPADVOGADO,
                DESPCART,
                DHBAIXA,
                DHMOV,
                DHTIPOPER,
                DHTIPOPERBAIXA,
                DH_IMPRESSAO,
                DIGSAFRA,
                DTALTER,
                DTBAIXAPREV,
                DTCONTAB,
                DTCONTABBAIXA,
                DTENTSAI,
                DTENTSAIINFO,
                DTINITREFAPURACAO,
                DTINTEGRACAOIPI,
                DTNEG,
                DTPRAZO,
                DTREFERENCIA,
                DTVENC,
                DTVENCINIC,
                EMVPIX,
                EXIGEISSQN,
                HISTORICO,
                IDLOTEFDIC,
                IDUNICO,
                INDRECEFDCONT,
                INFCOMPLEFDCONT,
                INSSRETIDO,
                IRFRETIDO,
                ISSRETIDO,
                JUROSAVP,
                LINHADIGITAVEL,
                M2,
                METODOCALCIRRF,
                MODELONFDES,
                MONIOCOREM,
                MOTNAORETERISSQN,
                NATUREZAOPERDES,
                NFCOMPLFIX,
                NFENTSEQFIX,
                NOMEEMITENTE_CMC7,
                NOSSONUM,
                NROIMPORT,
                NROLOTEGNRE,
                NUANTBANC,
                NUAPONTA,
                NUBCO,
                NUCAIXA,
                NUCCR,
                NUCHQ,
                NUCKC,
                NUCOMPENS,
                NUDEV,
                NUFIN,
                NUFTC,
                NUMBOR,
                NUMCONTRATO,
                NUMDOCARRECAD,
                NUMDUPL,
                NUMNFSE,
                NUMNOTA,
                NUMOCORRENCIAS,
                NUMOS,
                NUMPROCADMJUDIC,
                NUMREMESSA,
                NUNOTA,
                NUPED,
                NURENEG,
                NUVERBA,
                OBRACONSTCIVIL,
                ORDEMCARGA,
                ORIGEM,
                PARCRENEG,
                PDD,
                PIXTEF,
                PROVISAO,
                RATEADO,
                RECADIANTAMENTORURAL,
                RECDESP,
                RECEBCARTAO,
                RECEBIDO,
                REFATCON,
                REGESPTRIBUT,
                REJEICAOGNRE,
                SANGDESPDV,
                SEQCAIXA,
                SEQUENCIA,
                SERIENFDES,
                SERIENOTA,
                SITESPECIALRESP,
                STATUSGNRE,
                TIMBLOQUEADA,
                TIMCONTALANC,
                TIMCONTAREP,
                TIMCONTRATOADM,
                TIMCONTRATOLOC,
                TIMCONTRATOLTV,
                TIMDATADEJUR,
                TIMDHBAIXA,
                TIMDHGERREPASSE,
                TIMDHGERREPPARCIAL,
                TIMDTIMPBOL,
                TIMDTIMPBOLLOCAL,
                TIMDTREPASSE,
                TIMDTREPPARCIAL,
                TIMFECHAMENTO,
                TIMFECHAMENTOALU,
                TIMFINGARANTORIG,
                TIMIMOVEL,
                TIMNEGOCIACAO,
                TIMNOMEADVOGADO,
                TIMNUFINORIG,
                TIMNUMREG,
                TIMORIGEM,
                TIMORIGRENEG,
                TIMPARCELA,
                TIMRENEGCANCLOTE,
                TIMRENEGIMV,
                TIMRENEGLOTE,
                TIMREPINTELIGENTE,
                TIMREPPARCIAL,
                TIMRESCISAOLOC,
                TIMRESCISAOLTV,
                TIMSAC,
                TIMTIPOINTERMED,
                TIMTXADMGERALU,
                TIMVENDAIMV,
                TIMVENDALOTE,
                TIMVLRAMORTCONTRATO,
                TIMVLRCORRMONET,
                TIMVLRJUROCONTRATO,
                TIPAPURACAO,
                TIPJURO,
                TIPMARCCHEQ,
                TIPMULTA,
                TPAGNFCE,
                TROCOPDV,
                VALORPRESENTE,
                VENDAMAIS,
                VLRALIBERAR,
                VLRBAIXA,
                VLRCESSAO,
                VLRCHEQUE,
                VLRDESC,
                VLRDESCCALC,
                VLRDESCEMBUT,
                VLRDESDOB,
                VLRDESDOBCALC,
                VLRFATCARTAO,
                VLRGNREDOIS,
                VLRICMSXMLCTE,
                VLRINSS,
                VLRIRF,
                VLRISS,
                VLRJURO,
                VLRJUROEMBUT,
                VLRJUROLIB,
                VLRJURONEGOC,
                VLRMOEDA,
                VLRMOEDABAIXA,
                VLRMULTA,
                VLRMULTAEMBUT,
                VLRMULTALIB,
                VLRMULTANEGOC,
                VLRPROV,
                VLRVARCAMBIAL,
                VLRVENDOR
            ) VALUES (  PEDIDO_FIN.ABATIMENTO,
                        PEDIDO_FIN.ABATIMENTOCAN,
                        PEDIDO_FIN.AD_CHAVEPIX,
                        PEDIDO_FIN.AD_COBRANCATERC,
                        PEDIDO_FIN.AD_CODCONTA,
                        PEDIDO_FIN.AD_CODIGORECEITA,
                        PEDIDO_FIN.AD_DARFAPURACAO,
                        PEDIDO_FIN.AD_DARFCODREC,
                        PEDIDO_FIN.AD_DARFNUMREF,
                        PEDIDO_FIN.AD_DTINCPDD,
                        PEDIDO_FIN.AD_FGTSCODREC,
                        PEDIDO_FIN.AD_FGTSDIGLACRE,
                        PEDIDO_FIN.AD_FGTSINDICADOR,
                        PEDIDO_FIN.AD_FGTSNUMLACRE,
                        PEDIDO_FIN.AD_FORMALANCPIX,
                        PEDIDO_FIN.AD_GPSATUALMONET,
                        PEDIDO_FIN.AD_GPSCODPAGTO,
                        PEDIDO_FIN.AD_GPSCOMPETENCIA,
                        PEDIDO_FIN.AD_GPSVLRARREC,
                        PEDIDO_FIN.AD_GPSVLRINSS,
                        PEDIDO_FIN.AD_GPSVLROUTENT,
                        PEDIDO_FIN.AD_IDENTPIX,
                        PEDIDO_FIN.AD_INFPIX,
                        PEDIDO_FIN.AD_NUMCONTRATO,
                        PEDIDO_FIN.AD_NUMEROREFERENCIA,
                        PEDIDO_FIN.AD_PERIODOAPURACAO,
                        PEDIDO_FIN.AD_TAXASHOPEE,
                        PEDIDO_FIN.AD_TIPLANPIX,
                        PEDIDO_FIN.AD_TXID,
                        PEDIDO_FIN.AGENCIA_CMC7,
                        PEDIDO_FIN.ALIQICMS,
                        PEDIDO_FIN.AUTORIZADO,
                        PEDIDO_FIN.BAIXAAPI,
                        PEDIDO_FIN.BASEICMS,
                        PEDIDO_FIN.BASEINSS,
                        PEDIDO_FIN.BASEIRF,
                        PEDIDO_FIN.BLOQVAR,
                        PEDIDO_FIN.CARTA,
                        PEDIDO_FIN.CARTAODESC,
                        PEDIDO_FIN.CGC_CPF_CMC7,
                        PEDIDO_FIN.CHAVECTE,
                        PEDIDO_FIN.CHAVECTEREF,
                        PEDIDO_FIN.CHAVENFEGNRE,
                        PEDIDO_FIN.CHEQUERASTREADO_CMC7,
                        PEDIDO_FIN.CLASSIFCESSAOOBRA,
                        PEDIDO_FIN.CODBARRA,
                        PEDIDO_FIN.CODBCO,
                        PEDIDO_FIN.CODBCO_CMC7,
                        PEDIDO_FIN.CODCBE,
                        PEDIDO_FIN.CODCC,
                        PEDIDO_FIN.CODCENCUS,
                        PEDIDO_FIN.CODCFO,
                        PEDIDO_FIN.CODCIDFIMCTE,
                        PEDIDO_FIN.CODCIDINICTE,
                        PEDIDO_FIN.CODCONTATO,
                        PEDIDO_FIN.CODCTABCOINT,
                        PEDIDO_FIN.CODEMP,
                        PEDIDO_FIN.CODEMPBAIXA,
                        PEDIDO_FIN.CODFUNC,
                        PEDIDO_FIN.CODIGOBARRA,
                        PEDIDO_FIN.CODIMOVELRURAL,
                        PEDIDO_FIN.CODIPTU,
                        PEDIDO_FIN.CODLST,
                        PEDIDO_FIN.CODMOEDA,
                        PEDIDO_FIN.CODNAT,
                        PEDIDO_FIN.CODOBRA,
                        PEDIDO_FIN.CODOBSPADRAO,
                        PEDIDO_FIN.CODPARC,
                        PEDIDO_FIN.CODPROJ,
                        PEDIDO_FIN.CODRECEITA,
                        PEDIDO_FIN.CODREGUA,
                        PEDIDO_FIN.CODTIPOPER,
                        PEDIDO_FIN.CODTIPOPERBAIXA,
                        PEDIDO_FIN.CODTIPTIT,
                        PEDIDO_FIN.CODTRIB,
                        PEDIDO_FIN.CODUSU,
                        PEDIDO_FIN.CODUSUBAIXA,
                        PEDIDO_FIN.CODUSUCOBR,
                        PEDIDO_FIN.CODVEICULO,
                        PEDIDO_FIN.CODVEND,
                        PEDIDO_FIN.CONTA_CMC7,
                        PEDIDO_FIN.CUSTASPROCESSUAIS,
                        PEDIDO_FIN.DEPOSITOJUDICIAL,
                        PEDIDO_FIN.DESCRTPAGNFCE,
                        PEDIDO_FIN.DESDOBDUPL,
                        PEDIDO_FIN.DESDOBRAMENTO,
                        PEDIDO_FIN.DESPADVOGADO,
                        PEDIDO_FIN.DESPCART,
                        PEDIDO_FIN.DHBAIXA,
                        PEDIDO_FIN.DHMOV,
                        PEDIDO_FIN.DHTIPOPER,
                        PEDIDO_FIN.DHTIPOPERBAIXA,
                        PEDIDO_FIN.DH_IMPRESSAO,
                        PEDIDO_FIN.DIGSAFRA,
                        PEDIDO_FIN.DTALTER,
                        PEDIDO_FIN.DTBAIXAPREV,
                        PEDIDO_FIN.DTCONTAB,
                        PEDIDO_FIN.DTCONTABBAIXA,
                        PEDIDO_FIN.DTENTSAI,
                        PEDIDO_FIN.DTENTSAIINFO,
                        PEDIDO_FIN.DTINITREFAPURACAO,
                        PEDIDO_FIN.DTINTEGRACAOIPI,
                        PEDIDO_FIN.DTNEG,
                        PEDIDO_FIN.DTPRAZO,
                        PEDIDO_FIN.DTREFERENCIA,
                        PEDIDO_FIN.DTVENC,
                        PEDIDO_FIN.DTVENCINIC,
                        PEDIDO_FIN.EMVPIX,
                        PEDIDO_FIN.EXIGEISSQN,
                        PEDIDO_FIN.HISTORICO,
                        PEDIDO_FIN.IDLOTEFDIC,
                        PEDIDO_FIN.IDUNICO,
                        PEDIDO_FIN.INDRECEFDCONT,
                        PEDIDO_FIN.INFCOMPLEFDCONT,
                        PEDIDO_FIN.INSSRETIDO,
                        PEDIDO_FIN.IRFRETIDO,
                        PEDIDO_FIN.ISSRETIDO,
                        PEDIDO_FIN.JUROSAVP,
                        PEDIDO_FIN.LINHADIGITAVEL,
                        PEDIDO_FIN.M2,
                        PEDIDO_FIN.METODOCALCIRRF,
                        PEDIDO_FIN.MODELONFDES,
                        PEDIDO_FIN.MONIOCOREM,
                        PEDIDO_FIN.MOTNAORETERISSQN,
                        PEDIDO_FIN.NATUREZAOPERDES,
                        PEDIDO_FIN.NFCOMPLFIX,
                        PEDIDO_FIN.NFENTSEQFIX,
                        PEDIDO_FIN.NOMEEMITENTE_CMC7,
                        PEDIDO_FIN.NOSSONUM,
                        PEDIDO_FIN.NROIMPORT,
                        PEDIDO_FIN.NROLOTEGNRE,
                        PEDIDO_FIN.NUANTBANC,
                        PEDIDO_FIN.NUAPONTA,
                        PEDIDO_FIN.NUBCO,
                        PEDIDO_FIN.NUCAIXA,
                        PEDIDO_FIN.NUCCR,
                        PEDIDO_FIN.NUCHQ,
                        PEDIDO_FIN.NUCKC,
                        PEDIDO_FIN.NUCOMPENS,
                        PEDIDO_FIN.NUDEV,
                        SEQ_TGFFIN_NUFIN.NEXTVAL,
                        PEDIDO_FIN.NUFTC,
                        PEDIDO_FIN.NUMBOR,
                        PEDIDO_FIN.NUMCONTRATO,
                        PEDIDO_FIN.NUMDOCARRECAD,
                        PEDIDO_FIN.NUMDUPL,
                        PEDIDO_FIN.NUMNFSE,
                        PEDIDO_FIN.NUMNOTA,
                        PEDIDO_FIN.NUMOCORRENCIAS,
                        PEDIDO_FIN.NUMOS,
                        PEDIDO_FIN.NUMPROCADMJUDIC,
                        PEDIDO_FIN.NUMREMESSA,
                        PEDIDO_FIN.NUNOTA,
                        PEDIDO_FIN.NUPED,
                        PEDIDO_FIN.NURENEG,
                        PEDIDO_FIN.NUVERBA,
                        PEDIDO_FIN.OBRACONSTCIVIL,
                        PEDIDO_FIN.ORDEMCARGA,
                        PEDIDO_FIN.ORIGEM,
                        PEDIDO_FIN.PARCRENEG,
                        PEDIDO_FIN.PDD,
                        PEDIDO_FIN.PIXTEF,
                        PEDIDO_FIN.PROVISAO,
                        PEDIDO_FIN.RATEADO,
                        PEDIDO_FIN.RECADIANTAMENTORURAL,
                        PEDIDO_FIN.RECDESP,
                        PEDIDO_FIN.RECEBCARTAO,
                        PEDIDO_FIN.RECEBIDO,
                        PEDIDO_FIN.REFATCON,
                        PEDIDO_FIN.REGESPTRIBUT,
                        PEDIDO_FIN.REJEICAOGNRE,
                        PEDIDO_FIN.SANGDESPDV,
                        PEDIDO_FIN.SEQCAIXA,
                        PEDIDO_FIN.SEQUENCIA,
                        PEDIDO_FIN.SERIENFDES,
                        PEDIDO_FIN.SERIENOTA,
                        PEDIDO_FIN.SITESPECIALRESP,
                        PEDIDO_FIN.STATUSGNRE,
                        PEDIDO_FIN.TIMBLOQUEADA,
                        PEDIDO_FIN.TIMCONTALANC,
                        PEDIDO_FIN.TIMCONTAREP,
                        PEDIDO_FIN.TIMCONTRATOADM,
                        PEDIDO_FIN.TIMCONTRATOLOC,
                        PEDIDO_FIN.TIMCONTRATOLTV,
                        PEDIDO_FIN.TIMDATADEJUR,
                        PEDIDO_FIN.TIMDHBAIXA,
                        PEDIDO_FIN.TIMDHGERREPASSE,
                        PEDIDO_FIN.TIMDHGERREPPARCIAL,
                        PEDIDO_FIN.TIMDTIMPBOL,
                        PEDIDO_FIN.TIMDTIMPBOLLOCAL,
                        PEDIDO_FIN.TIMDTREPASSE,
                        PEDIDO_FIN.TIMDTREPPARCIAL,
                        PEDIDO_FIN.TIMFECHAMENTO,
                        PEDIDO_FIN.TIMFECHAMENTOALU,
                        PEDIDO_FIN.TIMFINGARANTORIG,
                        PEDIDO_FIN.TIMIMOVEL,
                        PEDIDO_FIN.TIMNEGOCIACAO,
                        PEDIDO_FIN.TIMNOMEADVOGADO,
                        PEDIDO_FIN.TIMNUFINORIG,
                        PEDIDO_FIN.TIMNUMREG,
                        PEDIDO_FIN.TIMORIGEM,
                        PEDIDO_FIN.TIMORIGRENEG,
                        PEDIDO_FIN.TIMPARCELA,
                        PEDIDO_FIN.TIMRENEGCANCLOTE,
                        PEDIDO_FIN.TIMRENEGIMV,
                        PEDIDO_FIN.TIMRENEGLOTE,
                        PEDIDO_FIN.TIMREPINTELIGENTE,
                        PEDIDO_FIN.TIMREPPARCIAL,
                        PEDIDO_FIN.TIMRESCISAOLOC,
                        PEDIDO_FIN.TIMRESCISAOLTV,
                        PEDIDO_FIN.TIMSAC,
                        PEDIDO_FIN.TIMTIPOINTERMED,
                        PEDIDO_FIN.TIMTXADMGERALU,
                        PEDIDO_FIN.TIMVENDAIMV,
                        PEDIDO_FIN.TIMVENDALOTE,
                        PEDIDO_FIN.TIMVLRAMORTCONTRATO,
                        PEDIDO_FIN.TIMVLRCORRMONET,
                        PEDIDO_FIN.TIMVLRJUROCONTRATO,
                        PEDIDO_FIN.TIPAPURACAO,
                        PEDIDO_FIN.TIPJURO,
                        PEDIDO_FIN.TIPMARCCHEQ,
                        PEDIDO_FIN.TIPMULTA,
                        PEDIDO_FIN.TPAGNFCE,
                        PEDIDO_FIN.TROCOPDV,
                        PEDIDO_FIN.VALORPRESENTE,
                        PEDIDO_FIN.VENDAMAIS,
                        PEDIDO_FIN.VLRALIBERAR,
                        PEDIDO_FIN.VLRBAIXA,
                        PEDIDO_FIN.VLRCESSAO,
                        PEDIDO_FIN.VLRCHEQUE,
                        PEDIDO_FIN.VLRDESC,
                        PEDIDO_FIN.VLRDESCCALC,
                        PEDIDO_FIN.VLRDESCEMBUT,
                        PEDIDO_FIN.VLRDESDOB,
                        PEDIDO_FIN.VLRDESDOBCALC,
                        PEDIDO_FIN.VLRFATCARTAO,
                        PEDIDO_FIN.VLRGNREDOIS,
                        PEDIDO_FIN.VLRICMSXMLCTE,
                        PEDIDO_FIN.VLRINSS,
                        PEDIDO_FIN.VLRIRF,
                        PEDIDO_FIN.VLRISS,
                        PEDIDO_FIN.VLRJURO,
                        PEDIDO_FIN.VLRJUROEMBUT,
                        PEDIDO_FIN.VLRJUROLIB,
                        PEDIDO_FIN.VLRJURONEGOC,
                        PEDIDO_FIN.VLRMOEDA,
                        PEDIDO_FIN.VLRMOEDABAIXA,
                        PEDIDO_FIN.VLRMULTA,
                        PEDIDO_FIN.VLRMULTAEMBUT,
                        PEDIDO_FIN.VLRMULTALIB,
                        PEDIDO_FIN.VLRMULTANEGOC,
                        PEDIDO_FIN.VLRPROV,
                        PEDIDO_FIN.VLRVARCAMBIAL,
                        PEDIDO_FIN.VLRVENDOR);
        END;
    END LOOP;

    -- COPIANDO IMPOSTOS DO PEDIDO PARA NOTA
    FOR PEDIDO_IMP IN (
        SELECT
            DIN.ALIQDESPACESS,
            DIN.ALIQDIFERENCIAL,
            DIN.ALIQINTDEST,
            DIN.ALIQPARADIFAL,
            DIN.ALIQUOTA,
            DIN.ALIQUOTADESON,
            DIN.ALIQUOTAEFET,
            DIN.ALIQUOTANORMAL,
            DIN.BASE,
            DIN.BASEDIFAL,
            DIN.BASEFCP,
            DIN.BASEFCPINT,
            DIN.BASENORMDIFICMS,
            DIN.BASERED,
            DIN.BASEREDEFET,
            DIN.CODBEN,
            DIN.CODIMP,
            DIN.CODINC,
            DIN.CODLST,
            DIN.CODNATREND,
            DIN.CODTRIBMUNISS,
            DIN.CODUSU,
            DIN.COMIVA,
            DIN.CST,
            DIN.DIGITADO,
            DIN.IDALIQ,
            DIN.IVA,
            DIN.MOTREDADREM,
            VAR.NUNOTA,
            DIN.PAUTA,
            DIN.PERCALIQADREMICMS,
            DIN.PERCFCP,
            DIN.PERCFCPINT,
            DIN.PERCINSSESPECIAL,
            DIN.PERCPARTDIFAL,
            DIN.PERCREDBASE,
            DIN.PERCREDBASEEFET,
            DIN.PERCREDPR,
            DIN.PERCREDVLRIPI,
            DIN.PERCVLR,
            DIN.RETEMFIN,
            DIN.SEQUENCIA,
            DIN.TIPCALCDIFAL,
            DIN.TIPCALCFCPESPEC,
            DIN.TIPO,
            DIN.TIPODEDISS,
            DIN.TIPOINSSESPECIAL,
            DIN.TPIRRFEXT,
            DIN.VALOR,
            DIN.VALORDESON,
            DIN.VALORDIFERENCIAL,
            DIN.VALOREFET,
            DIN.VLRCRED,
            DIN.VLRCREDPR,
            DIN.VLRDIFALDEST,
            DIN.VLRDIFALREM,
            DIN.VLRFCP,
            DIN.VLRFCPINT,
            DIN.VLRICMSMONODEV,
            DIN.VLRICMSMONODIF,
            DIN.VLRICMSPARADIFAL,
            DIN.VLRINSSESPECIAL,
            DIN.VLRREPDIFALFCP,
            DIN.VLRREPRED,
            DIN.VLRREPREDSEMDESC
        FROM TGFDIN DIN
            INNER JOIN TGFVAR VAR ON DIN.NUNOTA = VAR.NUNOTAORIG AND DIN.SEQUENCIA = VAR.SEQUENCIAORIG
        WHERE DIN.NUNOTA = P_NUNOTA        
    ) LOOP
        BEGIN
            INSERT INTO TGFDIN (
                ALIQDESPACESS,
                ALIQDIFERENCIAL,
                ALIQINTDEST,
                ALIQPARADIFAL,
                ALIQUOTA,
                ALIQUOTADESON,
                ALIQUOTAEFET,
                ALIQUOTANORMAL,
                BASE,
                BASEDIFAL,
                BASEFCP,
                BASEFCPINT,
                BASENORMDIFICMS,
                BASERED,
                BASEREDEFET,
                CODBEN,
                CODIMP,
                CODINC,
                CODLST,
                CODNATREND,
                CODTRIBMUNISS,
                CODUSU,
                COMIVA,
                CST,
                DHALTER,
                DIGITADO,
                IDALIQ,
                IVA,
                MOTREDADREM,
                NUNOTA,
                PAUTA,
                PERCALIQADREMICMS,
                PERCFCP,
                PERCFCPINT,
                PERCINSSESPECIAL,
                PERCPARTDIFAL,
                PERCREDBASE,
                PERCREDBASEEFET,
                PERCREDPR,
                PERCREDVLRIPI,
                PERCVLR,
                RETEMFIN,
                SEQUENCIA,
                TIPCALCDIFAL,
                TIPCALCFCPESPEC,
                TIPO,
                TIPODEDISS,
                TIPOINSSESPECIAL,
                TPIRRFEXT,
                VALOR,
                VALORDESON,
                VALORDIFERENCIAL,
                VALOREFET,
                VLRCRED,
                VLRCREDPR,
                VLRDIFALDEST,
                VLRDIFALREM,
                VLRFCP,
                VLRFCPINT,
                VLRICMSMONODEV,
                VLRICMSMONODIF,
                VLRICMSPARADIFAL,
                VLRINSSESPECIAL,
                VLRREPDIFALFCP,
                VLRREPRED,
                VLRREPREDSEMDESC
            ) VALUES (
                PEDIDO_IMP.ALIQDESPACESS,
                PEDIDO_IMP.ALIQDIFERENCIAL,
                PEDIDO_IMP.ALIQINTDEST,
                PEDIDO_IMP.ALIQPARADIFAL,
                PEDIDO_IMP.ALIQUOTA,
                PEDIDO_IMP.ALIQUOTADESON,
                PEDIDO_IMP.ALIQUOTAEFET,
                PEDIDO_IMP.ALIQUOTANORMAL,
                PEDIDO_IMP.BASE,
                PEDIDO_IMP.BASEDIFAL,
                PEDIDO_IMP.BASEFCP,
                PEDIDO_IMP.BASEFCPINT,
                PEDIDO_IMP.BASENORMDIFICMS,
                PEDIDO_IMP.BASERED,
                PEDIDO_IMP.BASEREDEFET,
                PEDIDO_IMP.CODBEN,
                PEDIDO_IMP.CODIMP,
                PEDIDO_IMP.CODINC,
                PEDIDO_IMP.CODLST,
                PEDIDO_IMP.CODNATREND,
                PEDIDO_IMP.CODTRIBMUNISS,
                PEDIDO_IMP.CODUSU,
                PEDIDO_IMP.COMIVA,
                PEDIDO_IMP.CST,
                SYSDATE, -- DHALTER
                PEDIDO_IMP.DIGITADO,
                PEDIDO_IMP.IDALIQ,
                PEDIDO_IMP.IVA,
                PEDIDO_IMP.MOTREDADREM,
                PEDIDO_IMP.NUNOTA,
                PEDIDO_IMP.PAUTA,
                PEDIDO_IMP.PERCALIQADREMICMS,
                PEDIDO_IMP.PERCFCP,
                PEDIDO_IMP.PERCFCPINT,
                PEDIDO_IMP.PERCINSSESPECIAL,
                PEDIDO_IMP.PERCPARTDIFAL,
                PEDIDO_IMP.PERCREDBASE,
                PEDIDO_IMP.PERCREDBASEEFET,
                PEDIDO_IMP.PERCREDPR,
                PEDIDO_IMP.PERCREDVLRIPI,
                PEDIDO_IMP.PERCVLR,
                PEDIDO_IMP.RETEMFIN,
                PEDIDO_IMP.SEQUENCIA,
                PEDIDO_IMP.TIPCALCDIFAL,
                PEDIDO_IMP.TIPCALCFCPESPEC,
                PEDIDO_IMP.TIPO,
                PEDIDO_IMP.TIPODEDISS,
                PEDIDO_IMP.TIPOINSSESPECIAL,
                PEDIDO_IMP.TPIRRFEXT,
                PEDIDO_IMP.VALOR,
                PEDIDO_IMP.VALORDESON,
                PEDIDO_IMP.VALORDIFERENCIAL,
                PEDIDO_IMP.VALOREFET,
                PEDIDO_IMP.VLRCRED,
                PEDIDO_IMP.VLRCREDPR,
                PEDIDO_IMP.VLRDIFALDEST,
                PEDIDO_IMP.VLRDIFALREM,
                PEDIDO_IMP.VLRFCP,
                PEDIDO_IMP.VLRFCPINT,
                PEDIDO_IMP.VLRICMSMONODEV,
                PEDIDO_IMP.VLRICMSMONODIF,
                PEDIDO_IMP.VLRICMSPARADIFAL,
                PEDIDO_IMP.VLRINSSESPECIAL,
                PEDIDO_IMP.VLRREPDIFALFCP,
                PEDIDO_IMP.VLRREPRED,
                PEDIDO_IMP.VLRREPREDSEMDESC
            );
        END;
    END LOOP;

    -- ATUALIZANDO SEQUENCIA DA TGFCAB
    BEGIN
        UPDATE TGFNUM TNUM
        SET    TNUM.ULTCOD  = V_NUNOTA_NOTA
        WHERE  TNUM.ARQUIVO = 'TGFCAB';
    END;

    P_NUNOTA_NOTA := V_NUNOTA_NOTA;

END;